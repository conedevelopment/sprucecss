@use 'sass:map';
@use 'sass:meta';
@use '../function' as *;
@use '../config' as *;

/// Create Center layout
/// @param {string} $gap - The gap between the container and the content.
/// @param {string} $max-width - The maximum width of the container.
/// @return {mixin} - The centered layout.
@mixin layout-center(
  $gap: m,
  $max-width: config('container-width', $layout)
) {
  @if map.has-key($spacers, $gap) {
    $gap: map.get($spacers, $gap);
  }

  margin-inline: auto;
  max-width: $max-width;
  padding-inline: $gap;
}

// Create Stack layout
@mixin layout-stack(
  $gap: m,
  $width: false,
  $align: none,
  $important: false,
  $split: 0
) {
  @if map.has-key($spacers, $gap) {
    $gap: map.get($spacers, $gap);
  }

  @if $align == left or $align == right {
    display: flex;
    flex-direction: column;
  }

  @if $align == left {
    align-items: flex-start;
  }

  @if $align == right {
    align-items: flex-end;
  }

  > * {
    margin-block-end: 0;
    margin-block-start: 0;

    @if $width and $align == none {
      width: 100%;
    }
  }

  > * + * {
    @if $important == true {
      margin-block-start: $gap !important;
    } @else {
      margin-block-start: $gap;
    }
  }

  @if meta.type-of($split) == number and $split > 0 {
    &:only-child {
      height: 100%;
    }

    > :nth-child(#{$split}) {
      margin-block-end: auto;
    }
  }

  @if meta.type-of($split) != number and $split < 1 {
    @warn 'The second parameter (split) must be a positive number.';
  }
}

// Create Grid layout
@mixin layout-grid(
  $gap: m,
  $minimum: 12.5rem
) {
  @if map.has-key($spacers, $gap) {
    $gap: map.get($spacers, $gap);
  }

  display: grid;
  gap: $gap;

  @supports (width: min(#{$minimum}, 100%)) {
    & {
      grid-template-columns: repeat(auto-fit, minmax(min(#{$minimum}, 100%), 1fr));
    }
  }
}

// Create Sidebar Layout
@mixin layout-sidebar(
  $gap: m,
  $sidebar-width: 18.75rem
) {
  @if map.has-key($spacers, $gap) {
    $gap: map.get($spacers, $gap);
  }

  display: flex;
  flex-wrap: wrap;
  gap: $gap;

  & > :first-child {
    flex-basis: $sidebar-width;
    flex-grow: 1;
  }

  & > :last-child {
    flex-basis: 0;
    flex-grow: 999;
    min-width: 50%;
  }
}

// Create instinctive flex layout.
@mixin layout-flex(
  $gap: m,
  $width-variable: --col-width
) {
  @if map.has-key($spacers, $gap) {
    $gap: map.get($spacers, $gap);
  }

  display: flex;
  flex-wrap: wrap;
  gap: $gap;

  > * {
    flex: 1 1 var(#{$width-variable});
  }
}
